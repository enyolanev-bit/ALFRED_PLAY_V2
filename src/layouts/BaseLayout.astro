---
/**
 * BaseLayout — Layout principal avec le canvas WebGL global.
 * Le canvas est en position fixed (z-index: 0), le contenu HTML scrolle par-dessus.
 */

import AudioToggle from '../components/ui/AudioToggle.astro';
import CustomCursor from '../components/ui/CustomCursor.astro';
import ProgressTimeline from '../components/ui/ProgressTimeline.astro';
import { DECADES } from '../lib/config/decades.js';

interface Props {
  title?: string;
  description?: string;
}

const {
  title = 'ALFRED PLAY — L\'histoire de l\'informatique',
  description = 'Un voyage immersif à travers l\'histoire de l\'informatique, de 1960 à 2026.',
} = Astro.props;
---

<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <title>{title}</title>

    <!-- Fonts — Space Grotesk (display) + Plus Jakarta Sans (body) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Couche 0 — Barre de progression timeline (z-index: 1000) -->
    <ProgressTimeline labels={DECADES.map(d => d.label)} />

    <!-- Couche 1 — Canvas WebGL (position: fixed, z-index: 0) -->
    <canvas id="webgl-canvas" aria-hidden="true"></canvas>

    <!-- Couche 2 — Contenu HTML scrollable (z-index: 1) -->
    <main>
      <slot />
    </main>

    <!-- Couche 3 — Overlay UI (z-index: 2) -->
    <div class="ui-overlay" id="ui-overlay">
      <AudioToggle />
    </div>

    <!-- Couche 4 — Curseur custom (z-index: 9999) -->
    <CustomCursor />

    <!-- Script d'initialisation — chargé côté client -->
    <script>
      import '../lib/core/init.js';
    </script>
  </body>
</html>

<style is:global>
  @import '../styles/global.css';
</style>
